# '''
# second step:
# train the coarse model for 1.5 epochs with a batch size of 32, with 4 images per subject
# with 𝜆𝑝ℎ𝑜=2.0, 𝜆𝑖𝑑=0.2, 𝜆𝑠𝑐=1.0, 𝜆𝑙𝑚𝑘=1.0, 𝜆𝑒𝑦𝑒=1.0, 𝜆𝜷=1𝑒−4, and 𝜆𝝍=1𝑒−4.

# Time:
# around 15min/1000iterations
# in total, needs around

#
output_dir: "/media/c723/SSD_1/demo/DECA_TR/coarse/0118_4090_resnet50_16_235_4r162350118/"
pretrained_modelpath: "/media/c723/SSD_1/demo/DECA_TR/pretrain/4090_resnet50_16_235_0118/model.tar"

#数据集地址
facescape_dir: "/media/c723/SSD_1/Datasets/FaceScape/fmview_train"
small_facescape_dir: "/media/c723/SSD_1/Datasets/FaceScape/small_facescape"
vggface2_dir: "/media/c723/SSD_1/Datasets/vggface2"
lymh_dir: "/media/c723/SSD_1/Datasets/LYMH"
aflw2000_dir: "/media/c723/SSD_1/Datasets/AFLW2000/image/1"

dataset:
  training_data: ['small_facescape','facescape','vggface2']
  eval_data: ['aflw2000']
  batch_size: 8
  K: 3
  isSingle: False
train:
  resume: True

  max_epochs: 30
  max_steps: 2000000
  log_steps: 500
  vis_steps: 500
  checkpoint_steps: 1000
  val_steps: 500
  eval_steps: 100000000
  lr: 1e-4 #5e-4
model:
  E_flame_backbone: 'resnet50'
  # face_eye_mask_path: "/home/wang/wal/demo_test/DECA/data/uv_face_eye_mask_y.png"
  face_eye_mask_path: "/media/c723/SSD_1/demo/DECA/data/uv_face_eye_mask_y.png"
#  flame_lmk_embedding_path: "/home/wang/wal/demo_test/DECA/data/res.npy"
loss:
  lmk_num: 235
  lmk: 1.
  eyed:  1.0  #1.0
  lipd: 1.0  #0.3
  photo: 2.0 #2.0
  useSeg: True
  id: 0.001 #0.5
  id_shape_only: False
  reg_shape: 1e-04
  reg_exp: 1e-04
  reg_tex: 1e-04
  reg_light: 1.
  reg_jaw_pose: 1. #1.
  #resnet50 convnext_v1  convnext_v2_tiny convnext_v2_atto

# loss:
#   shape_consistency: False
#   detail_consistency: False
#   useSeg: False
# python main_train.py --cfg configs/release_version/deca_coarse.yml